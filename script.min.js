function trackDt(t,e){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:t,...e})}function generateId(){const t="abcdefghijklmnopqrstuvwxyz0123456789";let e="";for(let n=0;n<16;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function calculatePing(t){let e,n=parseFloat(lengthInput.value),a=parseFloat(widthInput.value),r=parseFloat(areaInput.value);if("length"==t.target.getAttribute("id")||"width"==t.target.getAttribute("id")){if(!n||!a)return!1;let t=n/100,e=a/100;t>0&&e>0&&(r=t*e,areaInput.value=r.toFixed(2))}else"area"==t.target.getAttribute("id")&&(lengthInput.value="",widthInput.value="",n="",a="");r>0&&(e=r/3.3058,addRecord(n,a,r,e),areaInput.value="",lengthInput.value="",widthInput.value="")}function addRecord(t,e,n,a){const r=generateId(),o={length:t,width:e,area:n,ping:a,randomId:r};let d=JSON.parse(localStorage.getItem("history"))||[];d.unshift(o),d=d.slice(0,10),localStorage.setItem("history",JSON.stringify(d)),trackDt("calculate_ping",{ping:a,length:t,area:n,randomId:r}),showPopup(),renderHistory()}function renderHistory(){let t=JSON.parse(localStorage.getItem("history"))||[];historyTableBody.innerHTML="",t.forEach(t=>{const e=historyTableBody.insertRow();e.innerHTML=`\n        <td class="view">\n            <span class="view-value">\n            ${t.length||t.width?`${t.length||"  -  "} x ${t.width||"  -  "}`:""}\n            </span>\n        </td>\n        <td class="view"><span class="view-value">${t.area.toFixed(2)}</span></td>\n        <td class="view"><span class="view-value">${t.ping.toFixed(2)}</span></td>\n        <td class="js-control"><button class="delete-record-btn" onclick="deleteRecord(this)">X</button></td>\n    `,e.setAttribute("data-id",t.randomId)})}function clearHistory(){localStorage.removeItem("history"),history=[],renderHistory()}function deleteRecord(t){let e=t.parentNode.parentNode,n=e.getAttribute("data-id"),a=JSON.parse(localStorage.getItem("history")),r=a.findIndex(t=>t.randomId===n);-1!==r&&(a.splice(r,1),localStorage.setItem("history",JSON.stringify(a))),trackDt("delete_record",{randomId:n}),e.parentNode.removeChild(e)}function showPopup(){const t=document.getElementById("popup");t.classList.add("show"),setTimeout(function(){t.classList.remove("show")},3e3)}const lengthInput=document.getElementById("length"),widthInput=document.getElementById("width"),areaInput=document.getElementById("area"),historyTableBody=document.getElementById("historyBody"),clearHistoryButton=document.getElementById("clearHistory");lengthInput.addEventListener("change",calculatePing),widthInput.addEventListener("change",calculatePing),areaInput.addEventListener("change",calculatePing),clearHistoryButton.addEventListener("click",clearHistory),renderHistory();